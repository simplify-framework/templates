'use strict';
{{#RemoteExecutionMode}}
const AWS = require('aws-sdk');
const lambda = new AWS.Lambda({ apiVersion: '2015-03-31' });
{{/RemoteExecutionMode}}

module.exports.handler = function(event, context, callback) {
    {{#RemoteExecutionMode}}
    if (process.env.LOCAL_DEBUG=="YES") {
        require('../../../RemoteFunctions/{{Run.Name}}/src/index').handler(event, context, callback)
    } else {
        const parameters = require('./parameters.json')
        var params = {
            FunctionName: parameters.FunctionName, 
            Payload: Buffer.from(JSON.stringify({ event, context }), "utf-8")
        };
        lambda.invoke(params, function(err, data) {
            callback(err, JSON.parse(data.Payload))
        });
    }
    {{/RemoteExecutionMode}}
    {{^RemoteExecutionMode}}
    callback(null, [{
        title: "First Book",
        author: {
            id: "1234567891",
            name: "Star",
            type: "JOURNALIST"
        }
    }, {
        title: "Second Book",
        author: {
            id: "1234567890",
            name: "War",
            type: "SCIENTIST"
        }
    }, event.args])
    {{/RemoteExecutionMode}}
}
