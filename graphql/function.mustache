'use strict';
{{#RemoteExecutionMode}}
const AWS = require('aws-sdk');
const lambda = new AWS.Lambda({ apiVersion: '2015-03-31' });
{{/RemoteExecutionMode}}

module.exports.handler = function(event, context, callback) {
    {{#RemoteExecutionMode}}
    if (process.env.LOCAL_DEBUG=="YES") {
        require('../../../RemoteFunctions/{{Run.Name}}/src/index').handler(event, context, callback)
    } else {
        const parameters = require('./parameters.json')
        var params = {
            FunctionName: parameters.FunctionName, 
            Payload: Buffer.from(JSON.stringify({ event, context }), "utf-8")
        };
        lambda.invoke(params, function(err, data) {
            callback(err, JSON.parse(data.Payload))
        });
    }
    {{/RemoteExecutionMode}}
    {{^RemoteExecutionMode}}
    const {{functionName}}Result = {
{{#DataValues}}
        {{Name}}: {{#Value}}{{#isListType}}[ {{#isListStringType}}{{#Default}}"{{Value}}"{{#hasMore}}, {{/hasMore}}{{/Default}}{{/isListStringType}}{{^isListStringType}}{{#isJSONObject}}{{{Default}}}{{/isJSONObject}}{{^isJSONObject}}"{{{Default}}}"{{/isJSONObject}}{{/isListStringType}} ]{{/isListType}}{{^isListType}}{{#isObjectType}}{{{Default}}}{{/isObjectType}}{{^isObjectType}}{{#isBoolType}}{{Default}}{{/isBoolType}}{{^isBoolType}}"{{Default}}"{{/isBoolType}}{{/isObjectType}}{{/isListType}}{{/Value}}{{#hasMore}},{{/hasMore}}
{{/DataValues}}
    }
    callback(null, {{#isResultListType}}[ {{functionName}}Result, event.args ]{{/isResultListType}}{{^isResultListType}}{{functionName}}Result{{/isResultListType}})
    {{/RemoteExecutionMode}}
}
