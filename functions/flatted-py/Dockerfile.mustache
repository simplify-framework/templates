FROM python:alpine
ENV LOG_LEVEL "info"

COPY . /home/pyapp
RUN chmod +x /home/pyapp/docker-entrypoint.sh
RUN apk --update add curl ca-certificates &&\
    addgroup -g 1001 pyapp && \
    adduser -u 1001 -G pyapp -s /bin/sh -D pyapp && \
    cd /home/pyapp && npm install && \
    rm -rf /var/lib/apt/lists/* &&\
    rm -rf /var/cache/apk/*

# Run as the pyapp user ID.
USER pyapp

WORKDIR /home/pyapp

EXPOSE 3000

CMD ["python","main.py"]